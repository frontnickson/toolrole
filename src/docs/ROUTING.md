# Система маршрутизации Todo приложения

## Обзор

Система маршрутизации обеспечивает синхронизацию URL с состоянием приложения, позволяя пользователям:
- Прямо переходить к определенным режимам просмотра
- Открывать конкретные доски и задачи
- Делиться ссылками на определенные состояния приложения
- Использовать кнопки "Назад/Вперед" браузера

## Структура маршрутов

### Основные маршруты

```
/todo                           - Главная страница (по умолчанию board режим)
/todo/list                      - Режим списка
/todo/board                     - Режим доски
/todo/calendar                  - Режим календаря
```

### Маршруты с досками

```
/todo/list/:boardId             - Режим списка для конкретной доски
/todo/board/:boardId            - Режим доски для конкретной доски
/todo/calendar/:boardId         - Режим календаря для конкретной доски
```

### Маршруты с задачами

```
/todo/list/:boardId/task/:taskId        - Задача в режиме списка
/todo/board/:boardId/task/:taskId       - Задача в режиме доски
/todo/calendar/:boardId/task/:taskId    - Задача в режиме календаря
```

### Разделы

```
/todo/inbox                     - Входящие сообщения
/todo/today                     - Задачи на сегодня
/todo/home                      - Главная панель с статистикой
```

### Разделы с задачами

```
/todo/inbox/task/:taskId        - Задача из входящих
/todo/today/task/:taskId        - Задача на сегодня
/todo/home/task/:taskId         - Задача из главной панели
```

## Хук useTodoRouting

### Основные функции

```typescript
const {
  parseCurrentRoute,     // Парсит текущий URL
  navigateToMode,        // Навигация к режиму
  navigateToSection,     // Навигация к разделу
  navigateToTask,        // Навигация к задаче
  navigateToBoard,       // Навигация к доске
  closeTask,             // Закрытие задачи
  updateUrl,             // Обновление URL
  currentParams          // Текущие параметры из URL
} = useTodoRouting();
```

### Примеры использования

```typescript
// Переход к режиму списка
navigateToMode('list');

// Переход к доске в режиме доски
navigateToBoard('board-123', 'board');

// Открытие задачи
navigateToTask('task-456', 'board-123', 'board');

// Переход к разделу
navigateToSection('today');

// Обновление URL с новыми параметрами
updateUrl({ mode: 'calendar', boardId: 'board-123' });
```

## Автоматическая синхронизация

### При изменении состояния

- **Выбор доски**: URL обновляется на `/todo/board/:boardId`
- **Переключение режима**: URL обновляется соответственно
- **Открытие задачи**: URL добавляет `/task/:taskId`
- **Переход к разделу**: URL обновляется на `/todo/:section`

### При загрузке страницы

- **Восстановление режима**: Из URL восстанавливается режим просмотра
- **Восстановление доски**: Из URL восстанавливается выбранная доска
- **Восстановление задачи**: Из URL восстанавливается открытая задача
- **Восстановление раздела**: Из URL восстанавливается активный раздел

## Обратная совместимость

Старые маршруты продолжают работать:
- `/todo/task/:taskId` - автоматически перенаправляется на соответствующий режим

## Примеры URL

```
/todo                                    → Главная (board режим)
/todo/board/project-123                  → Доска "project-123" в режиме board
/todo/list/project-123/task/task-456     → Задача "task-456" в режиме list
/todo/today                              → Раздел "Задачи на сегодня"
/todo/inbox/task/task-789                → Задача из входящих
```

## Технические детали

### Парсинг URL

Хук `parseCurrentRoute` анализирует структуру URL и извлекает:
- `mode`: режим просмотра (list, board, calendar)
- `section`: раздел (inbox, today, home)
- `boardId`: ID доски
- `taskId`: ID задачи

### Обновление URL

Функция `updateUrl` принимает частичные параметры и обновляет URL, сохраняя существующие параметры, которые не были переопределены.

### Состояние приложения

URL синхронизируется с:
- `viewMode` - режим просмотра
- `activeNavItem` - активный раздел
- `selectedProject` - выбранная доска
- `selectedTaskId` - открытая задача
