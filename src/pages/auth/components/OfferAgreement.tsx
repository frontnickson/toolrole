import React, { useState } from 'react';
import Button from '../../../components/ui/Button/Button';
import styles from './AuthForms.module.scss';

interface OfferAgreementProps {
  onAccept: () => void;
  onDecline: () => void;
}

const OfferAgreement: React.FC<OfferAgreementProps> = ({ onAccept, onDecline }) => {
  const [isAccepted, setIsAccepted] = useState(false);
  const [isScrolledToBottom, setIsScrolledToBottom] = useState(false);

  const handleScroll = (e: React.UIEvent<HTMLDivElement>) => {
    const { scrollTop, scrollHeight, clientHeight } = e.currentTarget;
    const isAtBottom = scrollTop + clientHeight >= scrollHeight - 10;
    setIsScrolledToBottom(isAtBottom);
  };

  const handleAccept = () => {
    if (isAccepted && isScrolledToBottom) {
      onAccept();
    }
  };

  return (
    <div className={styles.offerContainer}>
      
      <div className={styles.offerHeader}>
        <h2>Соглашение об использовании сервиса</h2>
        <p className={styles.offerSubtitle}>
          Пожалуйста, внимательно ознакомьтесь с условиями использования
        </p>
      </div>

      <div 
        className={styles.offerContent}
        onScroll={handleScroll}
      >
        <div className={styles.offerText}>
          <h3>1. ОБЩИЕ ПОЛОЖЕНИЯ И ОПРЕДЕЛЕНИЯ</h3>
          <p>
            Настоящее Соглашение об использовании сервиса "Project Mind" (далее — "Соглашение") 
            определяет условия использования веб-приложения и мобильного приложения Project Mind 
            (далее — "Сервис"), разработанного и предоставляемого на условиях "как есть" (as is). 
            Сервис представляет собой платформу для организации задач, управления проектами, 
            планирования времени и повышения личной продуктивности. Использование Сервиса 
            подразумевает полное и безоговорочное согласие с настоящими условиями. 
            Администрация Сервиса оставляет за собой право в любое время изменять, 
            дополнять или исключать любые положения настоящего Соглашения без предварительного 
            уведомления пользователей. Продолжение использования Сервиса после внесения 
            изменений означает согласие с новыми условиями.
          </p>

          <h3>2. ОТКАЗ ОТ ГАРАНТИЙ</h3>
          <p>
            <strong>СЕРВИС ПРЕДОСТАВЛЯЕТСЯ БЕЗ КАКИХ-ЛИБО ГАРАНТИЙ.</strong> 
            Мы не гарантируем, что Сервис будет работать без ошибок, соответствовать 
            вашим ожиданиям или приносить какую-либо пользу. Использование Сервиса 
            осуществляется исключительно на ваш собственный риск.
          </p>

          <h3>3. ОГРАНИЧЕНИЕ ОТВЕТСТВЕННОСТИ</h3>
          <p>
            В максимальной степени, разрешенной законом, мы не несем ответственности 
            за любые прямые, косвенные, случайные, особые или штрафные убытки, 
            включая, но не ограничиваясь, потерей данных, прибыли, репутации или 
            возможностей, возникающих в связи с использованием или невозможностью 
            использования Сервиса.
          </p>

          <h3>4. ФУНКЦИОНАЛЬНОСТЬ СЕРВИСА</h3>
          <p>
            Сервис предназначен для организации задач и управления проектами. 
            Мы не гарантируем, что использование Сервиса приведет к повышению 
            продуктивности, улучшению результатов работы или достижению каких-либо 
            целей. Все результаты использования Сервиса зависят исключительно 
            от ваших личных усилий и обстоятельств.
          </p>

          <h3>5. ДОСТУПНОСТЬ СЕРВИСА</h3>
          <p>
            Мы не гарантируем непрерывную доступность Сервиса. Сервис может быть 
            временно недоступен по техническим причинам, для проведения технических 
            работ или по другим причинам без предварительного уведомления.
          </p>

          <h3>6. ИЗМЕНЕНИЯ В СЕРВИСЕ</h3>
          <p>
            Мы оставляем за собой право в любое время изменять, обновлять, 
            приостанавливать или прекращать работу Сервиса или любой его части 
            без предварительного уведомления и без какой-либо ответственности.
          </p>

          <h3>7. ПЕРСОНАЛЬНЫЕ ДАННЫЕ</h3>
          <p>
            Обработка персональных данных осуществляется в соответствии с 
            Политикой конфиденциальности. Мы не гарантируем абсолютную 
            безопасность ваших данных и не несем ответственности за их 
            утечку или несанкционированное использование третьими лицами.
          </p>

          <h3>8. ПРЕКРАЩЕНИЕ ДОСТУПА</h3>
          <p>
            Мы оставляем за собой право в любое время и без объяснения причин 
            ограничить, приостановить или прекратить ваш доступ к Сервису.
          </p>

          <h3>9. ПРИМЕНИМОЕ ПРАВО</h3>
          <p>
            Настоящее Соглашение регулируется законодательством Российской Федерации. 
            Все споры подлежат рассмотрению в судах по месту нахождения правообладателя.
          </p>

          <h3>10. СОГЛАСИЕ С УСЛОВИЯМИ</h3>
          <p>
            Используя Сервис, вы подтверждаете, что прочитали, поняли и согласны 
            соблюдать все условия настоящего Соглашения. Если вы не согласны с 
            какими-либо условиями, вы должны немедленно прекратить использование Сервиса.
          </p>

          <div className={styles.offerFooter}>
            <p><strong>Дата последнего обновления:</strong> 3 сентября 2025 года</p>
            <p><strong>Версия соглашения:</strong> 1.0</p>
          </div>
        </div>
      </div>

      <div className={styles.offerControls}>
        <div className={styles.checkboxContainer}>
          <input
            type="checkbox"
            id="offerAccept"
            checked={isAccepted}
            onChange={(e) => setIsAccepted(e.target.checked)}
            disabled={!isScrolledToBottom}
          />
          <label htmlFor="offerAccept" className={styles.checkboxLabel}>
            Я прочитал(а) и согласен(на) с условиями использования сервиса
          </label>
        </div>

        {!isScrolledToBottom && (
          <p className={styles.scrollHint}>
            Пожалуйста, прокрутите до конца документа, чтобы принять условия
          </p>
        )}

        <div className={styles.buttonGroup}>
          <Button
            variant="secondary"
            onClick={onDecline}
            className={styles.declineButton}
          >
            Отклонить
          </Button>
          <Button
            variant="primary"
            onClick={handleAccept}
            disabled={!isAccepted || !isScrolledToBottom}
            className={styles.acceptButton}
          >
            Принять условия
          </Button>
        </div>
      </div>

    </div>
  );
};

export default OfferAgreement;
