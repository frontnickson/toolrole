# Оптимизация загрузки задач досок

## Проблема
Задачи из колонок пропадали при обновлении страницы, и не было оптимизированной логики загрузки задач при выборе доски.

## Решение

### 1. Оптимизированная загрузка досок
- **До**: При загрузке всех досок загружались задачи для каждой доски сразу
- **После**: Доски загружаются без задач, задачи загружаются по требованию

### 2. Ленивая загрузка задач
- Задачи загружаются только при клике на доску
- Реализован кэш загруженных задач для избежания повторных запросов
- При изменении задач кэш автоматически очищается

### 3. Интегрированный хук useBoardTasks
Создан новый хук, который объединяет функциональность `useBoards` и `useTasks`:
- Автоматическая очистка кэша при изменении задач
- Синхронизация состояния между досками и задачами
- Оптимизированные API вызовы

## Изменения в коде

### useBoards.ts
- Добавлена функция `loadBoardTasks()` для загрузки задач конкретной доски
- Добавлен кэш `loadedBoardsCache` для отслеживания загруженных досок
- Функция `loadUserBoards()` теперь загружает доски без задач
- Добавлена функция `clearBoardTasksCache()` для очистки кэша

### useBoardTasks.ts (новый файл)
- Интегрированный хук, объединяющий функциональность досок и задач
- Автоматическая очистка кэша при создании/обновлении/удалении задач
- Единый интерфейс для работы с досками и задачами

### Todo.tsx
- Обновлена функция `handleProjectChange()` для загрузки задач при выборе доски
- Добавлен useEffect для загрузки задач при инициализации
- Использование нового интегрированного хука `useBoardTasks`

### TodoBoard.tsx
- Обновлен для использования нового хука `useBoardTasks`

## Преимущества

1. **Производительность**: Задачи загружаются только когда нужны
2. **Кэширование**: Избегание повторных запросов для уже загруженных досок
3. **Синхронизация**: Автоматическая очистка кэша при изменении данных
4. **UX**: Задачи не пропадают при обновлении страницы
5. **Масштабируемость**: Лучшая производительность при большом количестве досок

## API Endpoints

Используются существующие endpoints:
- `GET /api/v1/boards` - получение всех досок
- `GET /api/v1/boards/:boardId/tasks` - получение задач конкретной доски

## Логика работы

1. При загрузке приложения загружаются только доски (без задач)
2. При клике на доску загружаются задачи для этой доски
3. Загруженные задачи кэшируются
4. При изменении задач кэш очищается
5. При следующем обращении к доске задачи загружаются заново

## Тестирование

Для тестирования:
1. Создайте несколько досок с задачами
2. Переключайтесь между досками - задачи должны загружаться
3. Обновите страницу - задачи должны сохраняться
4. Создайте/измените задачу - кэш должен очиститься
5. Переключитесь на другую доску и обратно - задачи должны загрузиться заново

